<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <title>離場</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/WithDateLeave.css">
</head>
<body>
    <div class="topbar">
        <button onclick="jump('index')">回首頁</button>
    </div>
    <div class="IP">
        <h2>請選擇日期   <input type="date" id="Time"></h2>
        <div class="section-card">
            <div class="section-title">內部</div>
            <table id="Employee_Table">
                <tr>
                    <th>姓名</th>
                    <th>來訪廠區</th>
                    <th>部門編號</th>
                    <th>備註</th>
                    <th>進場時間</th>
                    <th>離場時間</th>
                    <th>離場補登</th>
                </tr>
                <!-- 員工資料會 JS append 在這裡 -->
            </table>
        </div>
        <div class="section-card">
            <div class="section-title">外部</div>
            <table id="Guest_Table">
                <tr>
                    <th>姓名</th>
                    <th>來訪公司</th>
                    <th>事由</th>
                    <th>受訪者</th>
                    <th>證號</th>
                    <th>備註</th>
                    <th>進場時間</th>
                    <th>離場時間</th>
                    <th>離場補登</th> 
                    <th>下載</th>
                </tr> 
                <!-- 訪客資料會 JS append 在這裡 -->
            </table>
        </div>
        <div class="button-row">
            <button onclick="send()">送出</button>
            <input type="hidden" id="factorySite" name="factorySite" value="">
        </div>
    </div>
    <script src="/js/loadtable_withdate.js?v=1.0.0"></script>
    <script src = "/js/pdf-lib.js"></script>
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            // 帶入 factorySite 隱藏欄位
            const params = new URLSearchParams(window.location.search);
            const factory = params.get("factory") || "";
            document.getElementById('factorySite').value = factory;
        });
    </script>
</body>
</html>
